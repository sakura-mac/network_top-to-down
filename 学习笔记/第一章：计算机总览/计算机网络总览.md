![](https://tva1.sinaimg.cn/large/008i3skNly1gtdz97tvwoj61jy0sgwgo02.jpg)

## 因特网描述

1. 什么是因特网？
2. 什么是协议？
3. 什么是网络边缘？
4. 什么是网络核心？
5. 关于延迟
6. 关于安全

![](https://tva1.sinaimg.cn/large/008i3skNly1gtdve16604j60fk0l2did02.jpg)

假设你明白了各个图标与英文的意思。想象一个关于网状的网络图（ISP），网内为网络核心，包含链路和分组转发机；边缘的服务器或主机为网络边缘。图中划分不同的网，各个ISP相互连接。

从总览角度来看我们优先关心数据运输，如何进行数据传输即需要协议来规定。

在网络中的运输允许服务器与客户端连接，也允许通过p2p直接连接，来加快速度。而运输过程涉及了延迟和安全的问题。

## 协议

我们在数据传输之前需要打招呼，二者合并称作通信。协议即通信的一系列的规则，如下图：

![](https://tva1.sinaimg.cn/large/008i3skNgy1gtdypq1qlqj611a0gsgnk02.jpg)

每个端系统和交换机都要遵循TCP协议，规定了传输数据的规范，顺带一提还有个IP，IP决定了分组格式。统称为TCP/IP

从为app提供服务角度来看，**端系统提供**了套接字接口，规定了端对端（应用层对运输层协议）的协议（后面会讲）。

## 网络边缘

主机和服务器。我们称为端系统

## 网络核心

网络核心包括通信链路和分组交换机。

考虑到传播速度是基本恒定的，交换机处理的时间也是固定的。

我们说带宽即传输速度，如2Mbps，每个分组交换机（路由器）的所有连接称为链路。而每个链路的链路资源：带宽是固定的，需要分配来实现并发。

那么，如何分配带宽呢？

### 电路交换

假设发送方和接收方的**连接**称为一条电路，那么对于两个路由器而言，链路包含了多条电路。对于整体而言，发送方和接收方的**连接**中各部分电路数必须相等。

电路交换即存在预留的链路资源，分为以下两种：

- FDM

- TDM

对于FDM，每条电路（连接）分配了固定频率，该电路持续性**获得部分带宽**。

对于TDM，每条电路周期性获得全部带宽**来获得部分带宽**。

以上说明全部针对传输，不考虑传播和路由器处理。当然电路交换也存在时延问题。

举例：电台，电话。

### 分组交换

分组交换不考虑预留链路资源（电路），而是共享链路资源，以组来划分传输最小单位。

大部分分组交换使用了存储转发传输，即传输必须之前必须接受一个完整的组。如果不这样，好像确实快（画图你就知道快了一个分组的传输时间），但是转发前必须处理分组，所以这不行。

1. 延迟

传输存在一定的延迟。

物理传播存在一定的延迟。

高并发时存在队列延迟问题。

超过路由器的缓冲区即存在丢包问题。

假如端对端系统之间有N-1个路由器，则延时为
$$
Ttotal=N（Tproc + Tdeque + Ttrans + Tpropa）
$$
同时，队列延迟启发了另一个问题：吞吐量

假设端对端系统之间只有一条链路，带宽为R，那么吞吐量在理想情况下为R，**定义为接收方的接收速度**。如果文件大小为F，则接收时间有
$$
T=F/R
$$
如果有N-1个路由器，带宽为Ri，那么则变为
$$
T=F/minRi
$$
则minRi所在链路为瓶颈链路，约束了传输时间。

理解：即使除了瓶颈链路以外任何一条链路无限快，在瓶颈链路以及之后的链路中，单位时间传输量仍然被瓶颈链路约束。（画个图你就知道了）。当然这里公式忽略了处理，协议，队列延时等问题。

2. 分割组：由于一个组传输后另一个组才能接着传输，因此分割组大小可以加快速度。

![](https://tva1.sinaimg.cn/large/008i3skNly1gtdvy0jwc8j60zq0c675p02.jpg)



### 分组交换和电路交换的比较

1. 用户等概率传输
2. 用户不等概率传输

考虑用户传输概率时，二者就会出现不同效率。在等概率情况下，并发用户传输数据对于同样带宽情况下等二者并没有什么区别：每个用户获得相同的部分带宽。

不等概率情况下，假设对于电路交换：某个小概率时刻一个用户上传了需要总带宽的数据，因此需要等待，而分组交换则不需要等待。

在并发超过总带宽时，就会产生队列，一个路由器的前后带宽比值决定了队列情况。当前者慢于后者时，队列才不会无限延长。当然此时电路交换更惨。



最后，我们的网络中端系统使用了链路和分组交换机来连接。因此这部分包含在了运输层协议里，规定了分组和传输规则。总的来说，对可靠性，吞吐量，定时，安全性做出了要求。



## 协议层次

我们知道协议分布在各个端系统上，如何来组织协议和描述信息分组呢？

从服务的角度看，协议通过分层来组织。每一层的协议对向上一层的协议提供服务，对下一层调用接口来使用服务。

自顶向下五层协议栈及其信息分组

1. 应用层：message（报文）
2. 传输层：segment（报文段）
3. 网络层：datagram（数据报）
4. 链接层：frame（帧）
5. 物理层：

传输数据时，每层协议封装信息分组后传入上一层，同样，每层协议增加信息分组内容后向下传入。具体流程如图：

![](https://tva1.sinaimg.cn/large/008i3skNly1gtdz2b93hvj612y0qwaei02.jpg)

## 网络安全

两种：狸猫换太子和占着茅坑不拉屎



![](https://tva1.sinaimg.cn/large/008i3skNly1gtdz39ol11j60w00bomxs02.jpg)

![](http://5b0988e595225.cdn.sohucs.com/images/20190710/cb77de49031b47e58babb60473468a75.jpeg)

